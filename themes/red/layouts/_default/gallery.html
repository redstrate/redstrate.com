{{ define "main" }}
    <h2>{{ .Title }}</h2>

    {{ .Content }}

    {{ $selected_year := $.Param "selectedyear" }}
    {{ $art := (index site.Data ($.Param "json")) }}

    <div class="grid">
    {{ range $art.categories }}
        {{ $should_include := false }}

        {{ range sort .years "year" "desc" }}
            {{ if eq (int .year) (int $selected_year) }}
                {{ $should_include = true }}
            {{ end }}
        {{ end }}

        {{ if $should_include }}
            {{ $without_space :=  replaceRE "(\\s)" "" .name }}
            {{ range sort .years "year" "desc" }}
                {{ if eq (int .year) (int $selected_year) }}
                    {{ $year := .year }}

                    {{ range .pieces }}
                            {{ $filename_without_ext := strings.TrimSuffix (path.Ext .filename) .filename }}

                            {{ $path := printf "/art/%s" $filename_without_ext}}
                            {{ with $.Site.GetPage $path }}
                                {{ partial "render-art" . }}
                            {{ end }}
                        {{ end }}
                {{ end }}
            {{ end }}
        {{ end }}
    {{ end }}
    </div>

    {{ $site := resources.Get "js/site.js" }}
    {{ if hugo.IsProduction }}
        {{ $site = $site | minify | fingerprint | resources.PostProcess }}
    {{ end }}
    <script src="{{ $site.RelPermalink }}" integrity="{{ $site.Data.Integrity }}"></script>
{{ end }}
